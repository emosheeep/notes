# HTTP协议的特点

- **无状态**：无状态，既是优点也是缺点

  - 优点在于只关心数据不关心状态时。无状态减少了额外信息，节省了带宽。
  - 正是因为无状态，所以某些需要状态的场合，在每次请求时都要带上全部的上下文信息，大量的重复造成了额外的开销。

- **明文传输**

- **可靠传输**：继承自TCP协议

- **灵活可拓展**：语义的自由和传输形式的多样性

# 各版本HTTP协议：

## HTTP/0.9

- 只有一个命令 GET
- 没有header等描述数据的信息
- 服务器发送完毕就关闭TCP连接

 

## HTTP/1.0

- 支持持久连接keep-alive，但默认使用非持久连接
- 增加了header和status code
- 多字符集支持、多部分发送、缓存、权限等
- 缓存主要使用Expires，if-modified-since

 

## HTTP/1.1

- 新增了很多方法如PUT，HEAD，OPTIONS
- 默认使用持久连接keep-alive
- 增加host和其它一些头部
- 缓存处理新增了如Etag，If-Match等等
- 引入range头，支持只请求资源的一部分，状态码（206 Partial Content）
- pipeline，同一个连接中可以发送多个请求，但需要按顺序来，队头阻塞问题

解决对头阻塞问题主要方法是，并发连接，但浏览器对同一个域名下的并发连接数量有限制，如chrome时6个，既然同一个有限制，还有一种解决办法就是将资源分配到不同的域名或CDN上。（并发连接和域名分片）

 

## HTTP/2（前身谷歌SPDY协议）

- **二进制协议**：所有数据以二进制传输，统称为帧，分为头部帧和数据帧。1.1中包头信息必须是文本。
- **多路复用**：由于分帧传输，同一个连接中，多个请求不需要按顺序发送，每帧数据只需携带ID值表明所属请求即可。（同一个请求的帧一定是按顺序发的，这里指的是不同的请求可以无序）。
- **数据流**：HTTP/2将每一个请求或回应的所有数据包称为一个数据流。每个数据流有一个唯一的编号，数据包发送时都会标记数据流ID，用来区分属于哪一个数据流。
- **头信息压缩**：由于HTTP协议没有状态，每次请求都需要附带上所有信息，导致请求头部大量重复，浪费带宽。HTTP/2一方面使用gzip压缩，另一方面引入头信息压缩机制，服务端客户端共同维护一张索引表，里面存有所有的头部，发送时只发序号，接受时根据序号找到对应的头部即可。并且，**HTTP2废除了起始行**，将起始行中的协议，路径，方法，状态码信息换成了头部，只不过这些头部以`:`开头，用以区分其他头部。
- **服务器推送（Server Push）**：允许服务器未经请求主动给客户端发送资源。使用服务器推送提前将必要的文件推送至客户端，一定程度上能减少延迟。注意推送的是静态资源。和WebSocket等方式发送及时数据的推送不一样。

### HTTP/2的问题：

由于使用多路复用，一个网站只需要一个TCP连接，而同一个TCP连接必定遵守同样的流量控制和拥塞控制，若一个数据流遭遇了拥塞，剩下的数据流就都发不出去。

 

## HTTP/3

谷歌研发的基于UDP的QUIC协议，在UDP协议的基础上实现了多路复用，有序交付，重传等功能。